{% include "nav/header.html" %}

<div class="container mt-5">
    <h2>Appointments</h2>
    <form method="get" action="/appointments" class="form-inline mb-3">
        <input type="text" name="search_patient" class="form-control mr-2" placeholder="Search Patient Name">
        <input type="text" name="search_doctor" class="form-control mr-2" placeholder="Search Doctor Name">
        <input type="date" name="search_date" class="form-control mr-2" placeholder="Search Date">
        <input type="time" name="search_time" class="form-control mr-2" placeholder="Search Time">
        <button type="submit" class="btn btn-primary">Search</button>
    </form>

    <table class="table table-bordered">
    <thead>
        <tr>
            <th>#</th>
            <th>Appointment ID</th>
            <th>Patient Name</th>
            <th>Doctor Name</th>
            <th>Cancellation Date</th>
            <th>Reason</th>
            <th>Cancelled By</th>
        </tr>
    </thead>
    <tbody>
        {% for cancellation in cancellations %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ cancellation.appointment_id }}</td>
            <td>{{ cancellation.patient_name }}</td>
            <td>{{ cancellation.doctor_name }}</td>
            <td>{{ cancellation.cancellation_date }}</td>
            <td>{{ cancellation.reason }}</td>
            <td>{{ cancellation.cancelled_by or 'Self' }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="7" class="text-center">No cancellations found</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

</div>

<script>
    // JavaScript to handle cancel button click and pass appointment_id to modal
    $(document).ready(function() {
        $('.cancel-btn').on('click', function() {
            var appointmentId = $(this).data('id');
            $('#appointment_id').val(appointmentId);
        });
    });
</script>


{% include "nav/footer.html" %}